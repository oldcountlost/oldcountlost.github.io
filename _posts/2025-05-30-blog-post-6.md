---
title: 'perturb-seq 数据分析： oNMF'
date: 2025-05-30
permalink: /posts/2025/05/blog-post-6/
tags:
  - perturbseq
  - gene program
  - regulatory network
  - NMF
---


对于NMF，其实现方法是，对于W和H的更新做乘法（不改变正负号），或者是矩阵的值下限设置为0。
oNMF在NMF的基础上多了一个限制，就是orthogonal，即正交。我们既可以设置W正交也可以设置H正交。
![what is oNMF]([../../../../images/oNMF_program_correlation.png](https://user-images.githubusercontent.com/50495107/182271297-015ab74c-69d6-4f79-b246-b5de6a709601.png))


对于基因数据，\\[\mathbf{E}\_{n \times g} = \mathbf{D}\_{n \times k} \cdot \mathbf{W}\_{k \times g} + \mathbf{C}\_{n \times c} \cdot \mathbf{M}\_{c \times g} + \mathbf{U}\_{n \times g}\\] 。我们设置其\\(\mathbf{W}\_{k \times g}\\)正交，即一个基因只能存在于一个gene program 中，\\(k\\)个gene program之间正交。


![gene program ~ KO group p-value](../../../../images/oNMF_program_correlation.png)
![gene program ~ KO group p-value](../../../../images/oNMF_program_embedding.png)

![gene program ~ KO group p-value](../../../../images/oNMF_program_KO_graph.png)
![gene program ~ KO group p-value](../../../../images/oNMF_program_KO_heatmap.png)




