---
title: 'Perturbseq数据分析中的遇到的问题记录'
date: 2025-03-18
permalink: /posts/2025/03/blog-post-2/
tags:
  - mixscape contrastiveVI NMF scenic decoupleR
  - python
  - perturbseq
---

近期在做perturbseq的数据分析，过程中比较不顺利，在此记录一下学习/踩坑的过程.


mixscape的原理以及潜在的问题
----
对于每一个perturbed cell $p \in P $，基因 $g \in G$ 的表达量为：
$$
E_{p,g}
$$ 
对于non-targeting control cells $ C $，表达矩阵为：
$$
E_{C,G}
$$
$\forall p \in P$，最近的$ n $个non-targeting control cells 为: 
$$
fnNN(n, E_{p,G}, E_{C,G})
$$
$\forall p \in P$, $\forall g \in G$, perturbation signature计算为：
$$
S_{p,g} = E_{p,g} - \frac{1}{n} (\sum_{i} (E_{i,g})), ( i \in fnNN(n, E_{p,G}, E_{C,G}))
$$
基于$S$,对每种KO $K$, 


根据每个细胞的perturbation signature

基于细胞系的perturbseq的问题
----
因为细胞系的细胞是高度的异质的，所以敲除掉目标基因后，给细胞的表达谱带来的影响有可能没有异质性带来的影响显著。这就导致，在进行PCA/UMAP/TSNE降维可视化时候，不同基因敲除后的细胞聚集在一起。此现象也有文献报导过，并且提供有相关的方法可以用来去除细胞系异质性的影响。
> 文献1
> 文献2



perturbseq数据鉴定gene program
----

