---
title: 'perturb-seq 数据分析：gene program(一) elastic-net regression'
date: 2025-05-31
permalink: /posts/2025/05/blog-post-5/
tags:
  - perturbseq
  - gene program
  - regulatory network
  - elastic-net
---


## 使用线性模型拟合表达矩阵

perturb-seq中\\(n\\)个细胞\\(g\\)个基因的的基因表达量数据为\\(\mathbf{E_{n \times g}}\\),基因敲除的组别数量为\\(k\\)，onehot编码的实验设计矩阵为\\(D_{n \times k}\\)，那么对应的每个实验组对于基因表达的扰动矩阵为\\(W_{k \times g}\\)，对于非实验因素，设计协变量矩阵，并且匹配对应的扰动矩阵\\(W2\\)。残差矩阵为\\(U_{n \times g}\\)。

线性模型为 \\[\mathbf{E_{n \times g}} = \mathbf{D_{n \times k}} \cdot \mathbf{W_{k \times g}} + \mathbf{C_{n \times c}} \cdot \mathbf{W2_{c \times g}} + \mathbf{U_{n \times g}} \\]
优化模型参数W和WC使得最小化MSE，即 \\[\mathop{\arg\min}\limits_{W,WC} \ \ \sum_{i=1}^{n} \sum_{j=1}^{g} u_{i,j}\\]


## 正则化操作的意义
### l1正则化(Lasso正则化)
在损失函数中，除了MSE项，额外加入了 \\(\sum \| w_{k,g} \|\\) ， 使得得到的基因的权重矩阵 \\(\mathbf{W}\\) 较为稀疏，倾向于挑选出少量正交的具有差异的基因。
### l2正则化(Ridge正则化)
在损失函数中，除了MSE项，额外加入了 \\(\sum w_{k,g}^2\\) ，使得得到的对于基因的权重矩阵  \\(\mathbf{W}\\) 中包含大量非零的极小值，倾向于认为每个基因都受到微量的扰动。
### l1+l2正则化(elastic-net正则化)
在损失函数中，除了MSE项，额外加入了 \\(\sum \| w_{k,g} \| + \sum w_{k,g}^2\\) ，使得得到的对于基因的权重矩阵 \\(\mathbf{W}\\) 中包含中等数量的非零值，结合了l1正则化特征挑选的优势与l2正则化兼顾全局的优势。

更加专业的解答可以参考：
 * [lasso-vs-ridge-vs-elastic-net](https://www.geeksforgeeks.org/lasso-vs-ridge-vs-elastic-net-ml/)
 * [正则化的pytorch实现](https://zhuanlan.zhihu.com/p/696909582)
## elastic-net regression的特点



